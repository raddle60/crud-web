#if($def && $def.id)
#set($page_title = "表单编辑")
<b>表单编辑</b>
#else
#set($page_title = "表单新增")
<b>表单新增</b>
#end
<form id="j_form" action="#springUrl("/def/def/save.htm")" method="post">
	<input type="hidden" name="id" value="$!{def.id}">
	<input type="hidden" name="defType" value="$!{def.defType}">
	<table>
		<tr>
			<th width="200">
				名称
			</th>
			<td>
				<input type="text" name="name" id="name" value="$!{def.name}">
			</td>
		</tr>
		<tr>
			<th>
				编码
			</th>
			<td>
				<input type="text" name="code" id="code" value="$!{def.code}">
			</td>
		</tr>
		<tr>
			<th>
				表单类型
			</th>
			<td>
				$!{def.defType}
			</td>
		</tr>
		<tr>
			<th>
				表名
			</th>
			<td>
				<input type="text" name="tableName" id="tableName" value="$!{def.tableName}">自动生成sql时
			</td>
		</tr>
		<tr>
			<th>
				数据源
			</th>
			<td>
				<select name="crudDsId" id="crudDsId">
					#foreach($datasource in $datasources)
						<option value="$datasource.id" #if($def.crudDsId && $def.crudDsId == $datasource.id)selected#end>$datasource.name</option>
					#end
				</select>
			</td>
		</tr>
		<tr>
			<th>
				预检查SQL
			</th>
			<td>
				执行sql前执行，返回0表示成功，其他值表示失败<br>
				<textarea name="preSql" id="preSql" rows="10" cols="80">$!{def.preSql}</textarea>
			</td>
		</tr>
		<tr>
			<th>
				SQL生成类型
			</th>
			<td>
				#foreach($sqlType in $sqlTypes)
					<label><input type="radio" name="sqlType" value="$!{sqlType}" #if($def.sqlType && $def.sqlType == $sqlType.name())checked#end>$!{sqlType}</label>
				#end
			</td>
		</tr>
		<tr>
			<th>
				SQL
			</th>
			<td>
				<textarea name="sql" id="sql" rows="20" cols="80">$!{def.sql}</textarea>
			</td>
		</tr>
		<tr>
			<th>
				创建时间列名
			</th>
			<td>
				<input type="text" name="createTmCol" id="createTmCol" value="$!{def.createTmCol}">插入时放入当前时间
			</td>
		</tr>
		<tr>
			<th>
				更新时间列名
			</th>
			<td>
				<input type="text" name="updateTmCol" id="updateTmCol" value="$!{def.updateTmCol}">更新时放入当前时间
			</td>
		</tr>
		<tr>
			<th>
			</th>
			<td>
				<input type="submit" value="保存">
			</td>
		</tr>
	</table>
</form>
<script>
$(function(){
	J_formValidator = $("#j_form").validate({
		onclick: false,
		onkeyup : false,
		rules : {
			name : { msg_required:{} },
			code : { msg_required:{} },
			defType : { msg_required:{}},
			crudDsId : { msg_required:{}},
			sqlType : { msg_required:{}}
		}
	});
});
</script>